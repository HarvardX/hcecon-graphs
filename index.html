<!DOCTYPE html>
<html>

<!------------ INSTRUCTIONS ------------------

1. Put this code into the HTML box.
1. Put the following files into the appropriate place in an Advanced HTML TE:
    - chart.min.js
    - chartjs-plugin-annotation.min.js
    - main.js
    - styles.css
2. Update the id on the <canvas> element to be unique for each chart 
   (e.g., "myChart1", "myChart2", etc.).
3. Update the chart_config variable in the <script> so that it points to the same element.
4. Put the settings you want into the config variable. 
   There are no settings available other than those shown,
   unless you want to modify the main.js file.

------------- END INSTRUCTIONS -------------->

<head>
  <title>Health Care Economics Interactive Demand Curve</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- Sources: -->
  <!-- https://www.chartjs.org/ -->
  <!-- https://www.chartjs.org/chartjs-plugin-annotation/latest/ -->
  <script>
    //////////// UPDATE THE CHART ID BELOW ////////////
    const chart_name = "myChart";
    //////////// Make sure it matches the <canvas> element's id ////////////
    // TODO: There's probably a better way to handle multiple charts on one page.
    if (typeof chart_config === 'undefined') {
      var chart_config = {}
    }
    chart_config[chart_name] = {
      x_values: [0, 2, 4, 6, 8, 10],
      x_label: "Quantity",
      y_values: [25, 20, 15, 10, 5, 0],
      y_label: "Price",
      title: "Demand Curve",
      restrictions: {
        monotonic_increasing: false,
        monotonic_decreasing: true, // Can't set both monotonics true at once.
        no_negative_values: true
      }
    }
    // Check to make sure the chart_config is set up correctly
    temp = Array.from(chart_config[chart_name].y_values);
    temp.sort(function (a, b) { return a - b });
    if (
      JSON.stringify(temp) !== JSON.stringify(chart_config[chart_name].y_values) &&
      chart_config[chart_name].restrictions.monotonic_increasing
    ) {
      console.error("Error: y_values must be in increasing order if you want monotonic increasing.");
    }
    temp = Array.from(chart_config[chart_name].y_values);
    temp.sort(function (a, b) { return b - a });
    if (JSON.stringify(temp) !== JSON.stringify(chart_config[chart_name].y_values) &&
      chart_config[chart_name].restrictions.monotonic_decreasing
    ) {
      console.error("Error: y_values must be in decreasing order if you want monotonic decreasing.");
    }
  </script>
</head>

<body>
  <main>
    <div style="max-width:700px;">
      <!---------- Make sure the <canvas> id below matches the chart_name variable ----------->
      <canvas id="myChart" class="chart_canvas" aria-label="Demand curve chart"></canvas>
      <!-- Inputs for keyboard users -->
      <!-- TODO: possibly add drag functionality to the chart -->
      <div class="y-values">
        <input type="number" id="y0" placeholder="0" value="0" aria-label="y value at x=0">
        <input type="number" id="y2" placeholder="0" value="0" aria-label="y value at x=2">
        <input type="number" id="y4" placeholder="0" value="0" aria-label="y value at x=4">
        <input type="number" id="y6" placeholder="0" value="0" aria-label="y value at x=6">
        <input type="number" id="y8" placeholder="0" value="0" aria-label="y value at x=8">
        <input type="number" id="y10" placeholder="0" value="0" aria-label="y value at x=10">
      </div>
      <!-- Slider to inspect x/y values and total monetary value -->
      <div class="controls">
        <input id="x-value-slider" type="range" min="0" max="10" step="0.1">
        <br>
        <span id="x-value-display" aria-live="polite">X: 0</span>
        <span id="y-value-display" aria-live="polite">Y: 0</span>
        <span id="area-under-curve-display" aria-live="polite">Area Of Rectangle: 0</span>
      </div>
    </div>

    <script src="js/chart.min.js"></script>
    <script src="js/chartjs-plugin-annotation.min.js"></script>
    <script src="js/main.js"></script>
  </main>
</body>

</html>